#!name = 百度贴吧
#!desc = 过滤百度贴吧广告
#!openUrl = https://apps.apple.com/app/id477927812
#!author = app2smile[https://github.com/app2smile], 可莉🅥[https://github.com/luestr/ProxyResource/blob/main/README.md]
#!tag = 去广告
#!system = 
#!system_version = 15
#!loon_version = 3.3.5(904)
#!homepage = https://github.com/sooyaaabo/Loon/blob/main/README.md
#!icon = https://raw.githubusercontent.com/sooyaaabo/Loon/main/Icon/App-Icon/BaiduTieba.png
#!date = 2025-10-24 20:00

# 2025-10-17
# https://raw.githubusercontent.com/app2smile/rules/master/plugin/tieba.plugin
# 2025-05-13 15:17:08
# https://kelee.one/Tool/Loon/Lpx/Tieba_remove_ads.lpx

[Argument]
per_filter_video_thread = select, "0", "1", tag = 推荐页不展示视频贴, desc = 设置为1则推荐页不展示视频贴

[Rule]
DOMAIN, 180.76.76.200, REJECT
IP-CIDR, 180.76.76.200/32, REJECT, no-resolve

[Rewrite]
^https:\/\/tieba\.baidu\.com\/c\/f\/member\/getMemberPopups$ reject-dict

^https:\/\/tiebac\.baidu\.com\/c\/u\/user\/profile$ response-body-json-del recom_naws_list namoaixud_entry custom_grid duxiaoman_entry finance_tab

^https:\/\/tiebac\.baidu\.com\/c\/u\/user\/profile$ response-body-json-replace user.shake_ad_switch.is_show 0

^https:\/\/tiebac\.baidu\.com\/c\/u\/user\/profile$ response-body-json-jq '.zone_info |= map(select(.type as $t | ["commerce","banner","game"] | index($t) | not))'

^https:\/\/tiebac\.baidu\.com\/c\/f\/sidebar\/home$ response-body-json-del task_list game_center tools tools.yunying_tools_list tools.show_tools_list
^https:\/\/tiebac\.baidu\.com\/c\/f\/sidebar\/home$ response-body-json-jq '.tools.show_tools_list |= map(.tools_list |= map(select(.title != "度小满钱包")))'

^https:\/\/tiebac\.baidu\.com\/c\/f\/search\/discover$ reject-dict

^https:\/\/tiebac\.baidu\.com\/c\/f\/frs\/frsBottom$ response-body-json-del card_activity

[Script]
http-response ^http(s:\/\/tiebac|:\/\/c\.tieba)\.baidu\.com\/(c\/(s\/sync|f\/(ad\/getSplashAd|frs\/(page|threadlist|generalTabList)|pb\/(pic)?page|excellent\/personalized))$|tiebaads\/commonbatch\?) script-path = https://raw.githubusercontent.com/app2smile/rules/master/js/tieba-json.js, requires-body = true, timeout = 10, tag = [百度贴吧]Json处理

http-response ^http(s:\/\/tiebac|:\/\/c\.tieba)\.baidu\.com\/c\/(b\/ad\/adBid|f\/(frs\/(page|threadlist|generalTabList)|ad\/getFeedAd|pb\/page|excellent\/personalized))\?cmd script-path = https://raw.githubusercontent.com/app2smile/rules/master/js/tieba-proto.js, requires-body = true, binary-body-mode = true, timeout = 10, tag = [百度贴吧]Proto处理, argument=[{per_filter_video_thread}]

[Mitm]
hostname = tiebac.baidu.com